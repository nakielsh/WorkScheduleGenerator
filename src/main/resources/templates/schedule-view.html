<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:style="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>WSG App</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

    <link href="https://cdnjs.cloudflare.com/ajax/libs/jquery-ui-bootstrap/0.5pre/css/custom-theme/jquery-ui-1.10.0.custom.css"
          rel="stylesheet"/>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jqueryui/1.11.2/jquery-ui.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.6.4/js/bootstrap-datepicker.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.6.4/css/bootstrap-datepicker.css"
          rel="stylesheet"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://kit.fontawesome.com/5af5eb3f80.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="../css/autocomplete.css">
<!--    <link href="https://unpkg.com/bootstrap-table@1.18.3/dist/bootstrap-table.min.css" rel="stylesheet">-->
<!--    <script src="https://cdn.jsdelivr.net/npm/tableexport.jquery.plugin@1.10.21/tableExport.min.js"></script>-->
<!--    <script src="https://cdn.jsdelivr.net/npm/tableexport.jquery.plugin@1.10.21/libs/jsPDF/jspdf.min.js"></script>-->
<!--    <script src="https://cdn.jsdelivr.net/npm/tableexport.jquery.plugin@1.10.21/libs/jsPDF-AutoTable/jspdf.plugin.autotable.js"></script>-->
<!--    <script src="https://unpkg.com/bootstrap-table@1.18.3/dist/bootstrap-table.min.js"></script>-->
<!--    <script src="https://unpkg.com/bootstrap-table@1.18.3/dist/extensions/export/bootstrap-table-export.min.js"></script>-->


    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.3.1/jspdf.umd.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.14/jspdf.plugin.autotable.min.js"></script>


</head>
<body>

<!-- Navigation -->
<div class="pos-f-t">
    <div class="collapse " id="navbarToggleExternalContent">
        <div class="d-flex bd-highlight">
            <div class="bg-white p-4 flex-grow-1 bd-highlight">
                <h5 class="text-dark h4">Thank you for using WSG App</h5>
                <span class="text-muted">See you later.</span>
                <div class="p-4 bd-highlight">
                    <a class="btn btn-outline-danger shadow bg-body rounded " th:href="@{/logout}">Logout
                        <i class="fas fa-sign-out-alt"></i>
                    </a>
                </div>
            </div>

            <div class="bg-white p-4 flex-grow-2 bd-highlight">
                <h5 class="text-dark h4">Check saved employees</h5>
                <span class="text-muted">Shows list of all saved employees in database</span>
                <div class="p-4 bd-highlight">
                    <a class="btn btn-outline-dark shadow bg-body rounded " th:href="@{/home/list-of-employees}">Show
                        list
                        <i class="fas fa-user-friends"></i>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<nav class="navbar navbar-light bg-light sticky-top d-flex bd-highlight">
    <div class="navbar-brand mr-auto p-2 bd-highlight" href="#">
        <img src="https://i.imgur.com/QbLHnon.png" width="100" height="30" class="d-inline-block align-top" alt="">
    </div>
    <div class="p-2 bd-highlight lead" th:text="'Welcome, ' + ${appuser}"></div>
    <div class="p-2 bd-highlight">
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarToggleExternalContent"
                aria-controls="navbarToggleExternalContent" aria-expanded="false" aria-label="Toggle navigation">
            <i class="fas fa-bars"></i>
        </button>
    </div>
</nav>

<div class="jumbotron jumbotron-fluid ">
    <div class="jumbotron jumbotron-fluid container text-center">

        <div>
            <h1 class="display-4">Your Generated Schedule</h1>
            <p>The schedule has been generated using BOE method for
                <a th:text="${schedule.monthName}" class="font-weight-bold"> </a>
                <a th:text="${schedule.year}" class="font-weight-bold"></a>
            </p>
            <hr class="my-4">
        </div>

    </div>
</div>


<div class="row">
    <div id="tables" class="container-fluid text-center table-responsive">
<!--        <div id="toolbar" class="select">-->
<!--            <select class="form-control">-->
<!--                <option value="">Export Basic</option>-->
<!--                <option value="all">Export All</option>-->
<!--                <option value="selected">Export Selected</option>-->
<!--            </select>-->

<!--        </div>-->
        <table th:if="${BOE1}" id="schedule"
               class="table mx-auto table-bordered table-striped table-hover caption-top shadow bg-body rounded dt-responsive nowrap"
               style="width: auto"
               data-show-export="true"
               data-pagination="false"
               data-side-pagination="server">
            <caption>Work Schedule</caption>
            <thead class="table-dark">
            <tr>
                <th scope="col">Name</th>
                <th th:each="day : ${map}" scope="col" th:text="${day.key}"></th>
                <th scope="col">Sum</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="employee :${employeeList}">
                <td th:text="${employee.name}" class="font-weight-bold"></td>
                <td th:each="day : ${map}">
                    <a th:if="${day.value.name == employee.name}" class="font-weight-bold text-danger">x</a>
                    <a th:unless="${day.value.name == employee.name}" class="font-weight-lighter text-secondary"></a>
                </td>
                <td th:text="${employee.numOfWorkingDays}" class="font-weight-bold"></td>
            </tr>
            </tbody>

        </table>
        <button onclick="generate()">Generate pdf</button>
        <script>
            function generate() {
                var doc = new jspdf.jsPDF('l', 'pt', 'a4')

                doc.autoTable({
                    html: '#schedule',
                    startY: 25,
                    // Default for all columns
                    styles: { overflow: 'ellipsize', cellWidth: 'wrap' },
                    columnStyles: { 0: { halign: 'center'},text: { cellWidth: 'auto' } },
                    headStyles: {halign: 'center', fillColor: [0, 0, 0] },
                    bodyStyles: {halign: 'center'},
                    // Override the default above for the text column
                    // columnStyles: { text: { cellWidth: 'auto' } },
                    theme: 'grid' })

                doc.save('schedule.pdf')
            }
        </script>



        <table th:if="${BOEMore}"
               class="table mx-auto table-bordered table-striped table-hover caption-top shadow bg-body rounded"
               style="width: auto">
            <caption>Work Schedule</caption>
            <thead class="table-dark">
            <tr>
                <th scope="col">Name</th>
                <th th:each="day : ${map}" scope="col" th:text="${day.key}"></th>
                <th scope="col">Sum</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="employee :${employeeList}">
                <td th:text="${employee.name}" class="font-weight-bold"></td>
                <td th:each="day : ${map}">
                    <a th:each="empl : ${day.value}">
                        <a th:if="${empl.name == employee.name}" class="font-weight-bold text-danger">x</a>
                        <a th:unless="${empl.name == employee.name}" class="font-weight-lighter text-secondary"></a>
                    </a>

                </td>
                <td th:text="${employee.numOfWorkingDays}" class="font-weight-bold"></td>
            </tr>
            </tbody>

        </table>
    </div>
    <button onclick="demoFromHTML();">PDF</button>
</div>
<hr class="my-4">

<div class="row">
    <div class="container text-center table-responsive">
        <table class="table table-striped table-hover caption-top shadow bg-body rounded" style="width: 100%">
            <caption>List of added users</caption>
            <thead class="table-dark">
            <tr>
                <th scope="col">#</th>
                <th scope="col">Name</th>
                <th scope="col">Availability</th>

                <!--                <th scope="col">Delete</th>-->
            </tr>
            </thead>
            <tbody>
            <tr th:each="employee :${employeeList}">
                <th scope="row" th:text="${employeeStat.index+1}"></th>
                <td class="font-weight-bold text-dark" th:text="${employee.name}"></td>
                <td>
                    <a class="font-weight-bold text-secondary" th:each="day, iterStat : ${employee.availability}"
                       th:text="${!iterStat.last} ? ${day} + ', ' : ${day} "></a>
                </td>
                <!--                <td>-->
                <!--                    <a th:href="@{/home/delete-employee/__${employee.name}__}"-->
                <!--                       class="btn btn-danger shadow bg-body rounded">Delete</a>-->
                <!--                </td>-->
            </tr>
            </tbody>

        </table>


        <table class="table table-striped table-hover caption-top shadow bg-body rounded" style="width: 100%">
            <caption>List of empty days</caption>
            <thead class="table-dark">
            <tr>
                <th scope="col">Day</th>
                <th scope="col">Possible Employees</th>
            </tr>
            </thead>
            <tbody>

            <tr th:block th:each="day : ${emptymap} ">
                <th scope="row" th:text="${day.key}"></th>
                <th scope="row" th:inline="text">
                    <a th:if="${day.value} != null" class="font-weight-bold text-wrap text-secondary"
                       th:each="empl, iterStat : ${day.value}"
                       th:text="${!iterStat.last}? ${empl} + ', ' : ${empl}"></a>
                    <a class="font-weight-bold text-secondary" th:if="${day.value} == null"> No possible Employee </a>
                </th>
            </tr>
            </tbody>

        </table>

        <div class="jumbotron">

            <p class="lead">
                Go back to adding employees
            <p>
                <a th:href="@{/home/post-delete-add}"
                   class="btn btn-outline-dark shadow bg-body rounded fa-2x">
                    <i class="fas fa-arrow-circle-left"></i>
                </a>
            </p>
            <hr class="my-4">
            </p>


            <p class="lead">
                Show information about generating algorithms
            </p>
            <hr class="my-4">
            <p>
            <div class="btn-group" role="group" aria-label="Basic example">
                <button class="btn btn-outline-dark btn-lg shadow bg-body " type="button" data-toggle="collapse"
                        data-target="#boe" aria-expanded="true" aria-controls="boe">
                    BOE
                </button>
                <button class="btn btn-outline-dark btn-lg shadow bg-body " type="button" data-toggle="collapse"
                        data-target="#boemul" aria-expanded="true" aria-controls="boemul">
                    BOEMul
                </button>
            </div>
            </p>

            <div class="row">
                <div class="col">
                    <div class="collapse multi-collapse" id="boe">
                        <div class="card card-body font-weight-light">
                            <p class="lead font-weight-bolder">BOE - Based On Equality</p>
                            <hr class="my-4">
                            Algorithm spares the work equally. Everyone has almost the same amount of working days.
                            <hr class="my-4">
                            <a class="btn btn-outline-dark shadow bg-body rounded"
                               th:href="@{/home/generated/based-on-equality}">Generate
                                schedule
                                <i class="fas fa-file-alt"></i>
                            </a>
                        </div>
                    </div>
                </div>
                <div class="col">
                    <div class="collapse multi-collapse" id="boemul">
                        <div class="card card-body font-weight-light">
                            <p class="lead font-weight-bolder">BOEMul - Based On Equality</p>
                            <hr class="my-4">
                            Algorithm spares the work equally. Everyone has almost the same amount of working days. You
                            can choose number of employees per day
                            <hr class="my-4">

                            <a class="btn btn-outline-dark shadow bg-body rounded dropdown-toggle" role="button"
                               id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"
                               th:href="@{/home/generated/based-on-equality2/__${num}__}">Generate
                                schedule
                                <i class="fas fa-file-alt"></i>
                            </a>

                            <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                                <a class="dropdown-item" th:each="i : ${#numbers.sequence(2, 10)}" th:value="${i}"
                                   th:text="${i}"
                                   th:href="@{/home/generated/based-on-equality2/__${i}__}">
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


</div>
</div>


</body>
<script>
    var $table = $('#schedule')

    $(function() {
            $table.bootstrapTable('destroy').bootstrapTable({
                exportDataType: $(this).val(),
                exportTypes: ['pdf']
                // columns: [
                //     {
                //         field: 'state',
                //         checkbox: true,
                //         visible: $(this).val() === 'selected'
                //     }
                    // ,
                    // {
                    //   field: 'id',
                    //   title: 'ID'
                    // }, {
                    //   field: 'name',
                    //   title: 'Item Name'
                    // }, {
                    //   field: 'price',
                    //   title: 'Item Price'
                    // }
                // ]
            })
        })
</script>

</html>